# gbdt理解
机器学习都得有**模型**，以及**损失函数**。
## 模型
![](/home/martin/Documents/1.png)

确定分割值确定了整个模型的结构，实际数据很多都是定量数据，这就涉及取阈值。这个其实是很重要的工作，但是很多文章都是介绍下面这个，也就是确定当前确定结构模型的参数，就是W。
## 损失函数
![](/home/martin/Documents/2.png)

L函数中只有一个变量就是各期的预测值，g<sub>i</sub>就是L函数的一阶导数在上期的取值。f<sub>i</sub>就是各个样本对应的w。

当前模型惩罚系数：

![](http://www.52cs.org/wp-content/uploads/2015/04/10.png)

把按照样本求和变成分成各个叶子节点然后再求和，原目标函数变成：

![](http://www.52cs.org/wp-content/uploads/2015/04/a.png)

模型结构确定后，各个节点的g，h都确定了，T也定了。$\lambda\gamma$也都定了，变的只有w。

![](/home/martin/Downloads/Firefox_Screenshot_2017-09-18T16-22-15.673Z.png)

模型只要结构确定了，参数w等于确定了。并且模型得分也知道了。sum部分可以看做每个叶子节点带来的信息增益。
## 确定模型
![](http://www.52cs.org/wp-content/uploads/2015/04/14.png)

左边划分阈值经历的过程如下：

![](http://www.52cs.org/wp-content/uploads/2015/04/image1.png)

选取得分最高时的阈值，当然这个的前提是选特征。选取不同的特征都有其最优的阈值，选择得分最高的那个特征。

这里还有一个没有解决的问题就是讲道理最优树只有一个，从最开始一个叶子节点也就是没有划分，到你自己设置的深度，对于确定的样本，这个模型是确定的。那么怎么构造出不同的树，然后ensemble。
